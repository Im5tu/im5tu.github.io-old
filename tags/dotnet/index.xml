<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dotnet on Stuart Blackler&#39;s Blog</title>
    <link>https://im5tu.io/tags/dotnet/index.xml</link>
    <description>Recent content in Dotnet on Stuart Blackler&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="https://im5tu.io/tags/dotnet/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>OpenMessage 2017 Roadmap</title>
      <link>https://im5tu.io/article/2017/02/openmessage-2017-roadmap/</link>
      <pubDate>Sat, 11 Feb 2017 12:15:27 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2017/02/openmessage-2017-roadmap/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://github.com/im5tu/openmessage&#34;&gt;OpenMessage&lt;/a&gt; originally started out as a replacement for an internal library that was used across teams. At the time, the team I was apart of needed the latest version of dotnet core for the library where as the other team were stuck on RC1. They were also developing features for that version of the framework and a few pre-existing details that we were unhappy with (eg: the request/response implementation). With that in mind, I created a minimal wrapper for what we needed. Looking forward, I plan to dedicate a bit more time to the project and improve it.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;h2 id=&#34;support-for-web-hook-scenarios&#34;&gt;Support for web hook scenarios&lt;/h2&gt;

&lt;p&gt;This is probably one of the bigger ideas that I have had in mind for the last month or so purely for the power that it could bring to applications. One of the core parts of our infrastructure was taking a web request generated by an external system and translating this into a message to be placed on Azure Service Bus. I see two main parts to this functionality:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Support for incomming web hooks&lt;/li&gt;
&lt;li&gt;Support for sending web hooks&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;For each portion, the framework will need to consider whether or not to send/receive to/from unique endpoints or an endpoint per message. Initially, this will be decided at composition, but may be extended to dynamic re-configuration at a later stage (which will need to be considered throughout the framework). I intend to use some lightweight routing to do this, probably using the routing module from ASP.Net core, at least, initialy.&lt;/p&gt;

&lt;h2 id=&#34;support-for-additional-providers&#34;&gt;Support for additional providers&lt;/h2&gt;

&lt;p&gt;The more providers that the project has, the more flexibility you can have inside of your applications. The main providers that I have in mind are as follows:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Azure Event Hubs&lt;/li&gt;
&lt;li&gt;Service Fabric Reliable Queues&lt;/li&gt;
&lt;li&gt;Rabbit MQ&lt;/li&gt;
&lt;li&gt;In Memory&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There isn&amp;rsquo;t really too much to say about each of the above, except that the project will have support for each framework using the native providers. I did toy with the idea of building a complete AMQP library as part of this, but that seems a little overkill for the time being. I&amp;rsquo;ll see how the progression of libraries moving to dotnet core takes shape as another full library is quiet the undertaking.&lt;/p&gt;

&lt;h2 id=&#34;sample-creation-tutorial-series&#34;&gt;Sample creation/tutorial series&lt;/h2&gt;

&lt;p&gt;One of the big pieces that is missing at the moment are public samples of how to use the project in your application. This will help ease the onboarding process for new users/developers.&lt;/p&gt;

&lt;p&gt;Naturally, as part of all of this work, the dependencies will be kept up-to-date &amp;amp; bugs fixed. If there is something that you&amp;rsquo;d like to see, create an issue on &lt;a href=&#34;https://github.com/im5tu/openmessage&#34;&gt;github&lt;/a&gt; or &lt;a href=&#34;https://twitter.com/im5tu&#34;&gt;tweet me&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Happy Messaging!&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>OpenMessage 1.1 Released</title>
      <link>https://im5tu.io/article/2017/02/openmessage-1.1-released/</link>
      <pubDate>Sun, 05 Feb 2017 15:31:54 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2017/02/openmessage-1.1-released/</guid>
      <description>&lt;p&gt;Just a quick update to say that the Azure provider for &lt;a href=&#34;https://github.com/Im5tu/OpenMessage&#34;&gt;OpenMessage&lt;/a&gt; has been released. This update fixes an issue with scheduling messages on topics.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;As part of this update, the entire solution has been converted to the new (old) csproj system as part of Visual Studio 2017. Over the next few days i&amp;rsquo;ll be posting the roadmap for the project and where I plan to take it next. Feedback and ideas are welcome.&lt;/p&gt;

&lt;p&gt;If you experience any problems, let me know.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Dev Lunches: What, Why, How</title>
      <link>https://im5tu.io/article/2014/12/dev-lunches-what-why-how/</link>
      <pubDate>Wed, 17 Dec 2014 18:36:09 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/12/dev-lunches-what-why-how/</guid>
      <description>&lt;p&gt;If you&amp;rsquo;re not up-to-date, you fall behind. You fall behind in your work, which leads you to fall behind at home. If continued, it&amp;rsquo;s a never ending circle that can seem like climbing Everest in order to overcome. I propose that we, as developers, start doing is utilizing our free time to help not only ourselves but our co-workers too. We can do this via dev lunches.  &lt;/p&gt;

&lt;h2 id=&#34;so-what-is-a-dev-lunch&#34;&gt;So what is a dev lunch?&lt;/h2&gt;

&lt;p&gt;A dev lunch, or developers lunch, is based upon the idea of sacrificing an hours lunch on a specific topic or topics, much like a mini-conference for you and your co-workers. Topics can range for technical deep dives to non-technical, team-wide talks such as &amp;ldquo;What does it mean to be Agile?&amp;rdquo;. The format is typically manifests as one of two styles:&lt;/p&gt;

&lt;h3 id=&#34;single-talks&#34;&gt;Single talks&lt;/h3&gt;

&lt;p&gt;With a single talk, a developer will take the topic in hand, research the subject and present it to the attendees. The talk will typically last about 30-40 minutes leaving time for Q&amp;amp;A etc.&lt;/p&gt;

&lt;h3 id=&#34;lightning-talks&#34;&gt;Lightning talks&lt;/h3&gt;

&lt;p&gt;Lightning talks take the form of a series of individuals from the team presenting for x time on a range of subjects. X is usually around 5-10 minutes. The subjects can be related, or completely unrelated. Essentially, they are multiple, compressed single talks.&lt;/p&gt;

&lt;p&gt;It is important to remember that the topics are chosen by the presenter themselves. The presenter may ask for ideas/feedback from the team.&lt;/p&gt;

&lt;h2 id=&#34;why-invest-in-dev-lunches&#34;&gt;Why invest in dev lunches?&lt;/h2&gt;

&lt;p&gt;In my opinion, the benefits from the developer and business perspectives are pretty much the same:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Knowledge is shared throughout the team&lt;/li&gt;
&lt;li&gt;Can be used as a sort of team bonding&lt;/li&gt;
&lt;li&gt;Encourages the use of soft skills&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;how-do-i-get-started&#34;&gt;How do I get started?&lt;/h2&gt;

&lt;p&gt;For starters, you&amp;rsquo;ve read up until here so the idea is already in your mind. In terms of setting up the event, pick a date/time about &lt;sup&gt;3&lt;/sup&gt;&amp;frasl;&lt;sub&gt;4&lt;/sub&gt; weeks in the future to give you time to prepare and allow people to keep that hour free. Then you can have a think of an idea like those listed at the bottom of the page. Once you have that sorted, simply send out a meeting request (or similar) letting people know what you are doing, when and where.&lt;/p&gt;

&lt;p&gt;The presentations don&amp;rsquo;t have to be anything too fancy, just something on &lt;a href=&#34;http://slid.es&#34;&gt;Slid.es&lt;/a&gt; or Powerpoint will be fine. Just make sure that it is easily readable.&lt;/p&gt;

&lt;p&gt;Don&amp;rsquo;t forget to talk to your boss and let them know what you are doing. On the off chance see if there is a chance of free food, you never know right?&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve already started this movement at two places I have worked and received exceptional feedback. So I encourage you to try and sort this at your workplace and see if it can help you become better. Here are a couple of tips from my experience:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;You don&amp;rsquo;t need to be an expert, so don&amp;rsquo;t try and become one overnight,&lt;/li&gt;
&lt;li&gt;It doesn&amp;rsquo;t matter if things go wrong, the attendees are your friends and can help,&lt;/li&gt;
&lt;li&gt;Don&amp;rsquo;t pick a topic that is a) no interest to you, it will come off in your presentation; and b) too big, you will end up speed talking.&lt;/li&gt;
&lt;li&gt;Do remember to have fun!&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;resources&#34;&gt;Resources&lt;/h3&gt;

&lt;h4 id=&#34;list-of-starter-ideas&#34;&gt;List of starter ideas&lt;/h4&gt;

&lt;p&gt;With these topics, explore the title trying to think of what/why/how&amp;hellip;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Principals of SOLID&lt;/li&gt;
&lt;li&gt;Dependency Injection&lt;/li&gt;
&lt;li&gt;Grunt Tasks&lt;/li&gt;
&lt;li&gt;What does it mean to be Agile?&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;speaker-resources&#34;&gt;Speaker Resources&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.hanselman.com/speaking/&#34;&gt;http://www.hanselman.com/speaking&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://zachholman.com/talk/the-talk-on-talks/&#34;&gt;Talk on Talks&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>Message Queue Fundementals: MSMQ</title>
      <link>https://im5tu.io/article/2014/09/message-queue-fundementals-msmq/</link>
      <pubDate>Sun, 28 Sep 2014 18:35:57 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/09/message-queue-fundementals-msmq/</guid>
      <description>&lt;p&gt;MSMQ is Microsoft&amp;rsquo;s Message Queuing service that can be used to implement both synchronous and asynchronous solutions. Typically solutions are architectured using the available C++ API’s or via the relevant COM objects. The .Net Framework exposes the System.Messaging namespace which contains all the classes that you need to work with the MSMQ API. &lt;/p&gt;

&lt;p&gt;If you would like to read the first part to the article, &lt;a href=&#34;http://sblackler.net/2014/09/07/Message-Queue-Fundementals-Introduction/&#34;&gt;click here to read about Message Queue Fundamentals&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In this article I will cover the following topics:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Types of Queues in MSMQ

&lt;ul&gt;
&lt;li&gt;Application Queues

&lt;ul&gt;
&lt;li&gt;Public/Private Queues&lt;/li&gt;
&lt;li&gt;Transactional and non-transactional Queues&lt;/li&gt;
&lt;li&gt;Sub-Queues&lt;/li&gt;
&lt;li&gt;Administration Queues&lt;/li&gt;
&lt;li&gt;Response Queues&lt;/li&gt;
&lt;li&gt;Report Queues&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;System Queues

&lt;ul&gt;
&lt;li&gt;Journal Queues&lt;/li&gt;
&lt;li&gt;Internal Private Queues&lt;/li&gt;
&lt;li&gt;Dead-letter Queues&lt;/li&gt;
&lt;li&gt;Connector Queues&lt;/li&gt;
&lt;li&gt;Outgoing Queues&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Creating an MSMQ Message Queue&lt;/li&gt;
&lt;li&gt;Accessing an MSMQ Message Queue&lt;/li&gt;
&lt;li&gt;Sending a message to a MSMQ Message Queue

&lt;ul&gt;
&lt;li&gt;Sending a message to a MSMQ Message Queue using transactions&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Retrieving a message from a MSMQ Message Queue

&lt;ul&gt;
&lt;li&gt;Retrieving a message from a MSMQ Message Queue using transactions&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Before you begin, you need to have MSMQ installed on your machine, please do this by following &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/aa967729(v=vs.110).aspx&#34;&gt;these instructions&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&#34;types-of-queues-in-msmq&#34;&gt;Types of Queues in MSMQ&lt;/h2&gt;

&lt;p&gt;This section describes the available queue types within MSMQ. Although I will not cover the consumption of all the available types of queue, I will briefly describe the following type of queue:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Application Queues

&lt;ul&gt;
&lt;li&gt;Public/Private Queues&lt;/li&gt;
&lt;li&gt;Transactional and non-transactional Queues&lt;/li&gt;
&lt;li&gt;Sub-Queues&lt;/li&gt;
&lt;li&gt;Administration Queues&lt;/li&gt;
&lt;li&gt;Response Queues&lt;/li&gt;
&lt;li&gt;Report Queues&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;System Queues

&lt;ul&gt;
&lt;li&gt;Journal Queues&lt;/li&gt;
&lt;li&gt;Internal Private Queues&lt;/li&gt;
&lt;li&gt;Dead-letter Queues&lt;/li&gt;
&lt;li&gt;Connector Queues&lt;/li&gt;
&lt;li&gt;Outgoing Queues&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The quintessential difference between application and system queues is the ability to address messages to the queue. With application queues you can have, essentially, read/write capabilities, whereas you can only read messages from a system queue.&lt;/p&gt;

&lt;h3 id=&#34;administration-queues&#34;&gt;Administration Queues&lt;/h3&gt;

&lt;h4 id=&#34;private-vs-public-queues&#34;&gt;Private vs Public Queues&lt;/h4&gt;

&lt;p&gt;Deciding between a public and private queue depends on the requirements of the application and the infrastructure available. Public queues use Active Directory Domain Services to replicate the queue through the domain forest, providing reliability. They are both persistent and available to other applications. In contrast, private queues are only displayed on the local computer that contains them. Because private queues involve no replication, they are quicker to create, have lower latency and has no replication overhead as they are not distributed through a domain forest.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;For further on the permissions required for a public queue, please see &lt;a href=&#34;http://technet.microsoft.com/en-us/library/cc772532.aspx&#34;&gt;this Technet article&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&#34;transactional-vs-non-transactional-queues&#34;&gt;Transactional vs Non-Transactional Queues&lt;/h4&gt;

&lt;p&gt;As the name suggests, a transactional queue that only contains transactional messages. That is, when a message is written to/read from the queue the server/client must confirm the receipt of the message before the message can be removed from/added to the message queue. In contrast, a non-transactional queue each message is sent as a single operation (regardless of how many destinations the message is sent to), so there are no guarantees that messages will reach their destination. This is similar to TCP vs UDP. TCP (Transactional) guarantees message delivery where as UDP (Non-transactional) does not.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;For more information on transactional and non-transactional messaging, please see &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms704006(v=vs.85).aspx&#34;&gt;this MSDN article&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&#34;sub-queues&#34;&gt;Sub-Queues&lt;/h4&gt;

&lt;p&gt;Sub-Queues are useful for a variety of scenarios including work order processing and poison message handling. Work order processing is the process in which line items are ordered in a more efficient manner for processing. Poison message handling involves dealing with messages that have exceeded the send timeout; hit the retry limit; or any application specific error such as a transaction timeout. For a more detailed explanation of poison messages, I would suggest reading the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms789028(v=vs.110).aspx&#34;&gt;Poison Message Handling article on MSDN&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Unlike normal queues, the act of passing a message to a sub-queue invokes the creation of the queue if it does not already exist. If the sub-queue exists, the message is passed into the queue as normal. Furthermore, when the queue is empty and there are no open handles to the sub-queue, MSMQ removes the queue on your behalf. Apart from these main differences, sub-queues share the same properties as their parent queue, eg:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Quota&lt;/li&gt;
&lt;li&gt;Access Control List (ACL)&lt;/li&gt;
&lt;li&gt;Transactional Type&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;administration-queues-1&#34;&gt;Administration Queues&lt;/h4&gt;

&lt;p&gt;Typically, you would not be accessing administration queues as they are application-generated for the purpose of positive/negative message acknowledgement. Although any non-transactional queue can be defined as an administration queue, I will not be covering this type of queue any further.&lt;/p&gt;

&lt;h4 id=&#34;response-queues&#34;&gt;Response Queues&lt;/h4&gt;

&lt;p&gt;Like administration queues, response queues are application generated that store application generated response messages returned by an application that is reading messages. Unlike administration queues however, any available queue can be specified as a response queue. Since MSMQ has no control over the contents of a message in a response queue, it is up to the receiving application to understand and process the message correctly.&lt;/p&gt;

&lt;h4 id=&#34;report-queues&#34;&gt;Report Queues&lt;/h4&gt;

&lt;p&gt;Each computer that has MSMQ installed can have a single report queue created on it. This is an application-generated queue that is used to store report messages that detail the route that the message took in order to reach its destination. The queue must have the following label and queue type identifier:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Label: MQReport Queue&lt;/li&gt;
&lt;li&gt;Queue type identified: &lt;code&gt;{55EE8F32-CCE9-11CF-B108-0020AFD61CE9}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A report queue can either be created through Active Directory Users and Computers, or programmatically if the correct label and queue type identifier has been specified.&lt;/p&gt;

&lt;h3 id=&#34;system-queues&#34;&gt;System Queues&lt;/h3&gt;

&lt;h4 id=&#34;journal-queues&#34;&gt;Journal Queues&lt;/h4&gt;

&lt;p&gt;A journal queue is presented in two forms: A Queue Journal &amp;amp; A Computer Journal. A queue journal details all of the messages that have been removed from a queue. A computer journal contains copies of all the messages that are sent from a computer. Typically, you would use these queues for message diagnosis and audit purposes only.&lt;/p&gt;

&lt;h4 id=&#34;internal-private-queues&#34;&gt;Internal Private Queues&lt;/h4&gt;

&lt;p&gt;Internal queues are at the core of MSMQ. They are used as interim queues for storing and forwarding messages to a destination queue. They are not published in AD DS and are local to the current computer.&lt;/p&gt;

&lt;h4 id=&#34;dead-letter-queues&#34;&gt;Dead-Letter Queues&lt;/h4&gt;

&lt;p&gt;Dead-letter queues contain messages that cannot be delivered. MSMQ provides a transactional dead-letter queue and a non-transactional dead-letter queue. The process of storing undelivered messages on a source computer is sometimes referred to as negative source journalling. Applications can only read or delete messages from a dead letter queue. Sending to the queue is handled by the MSMQ internals.&lt;/p&gt;

&lt;h4 id=&#34;connector-queues&#34;&gt;Connector Queues&lt;/h4&gt;

&lt;p&gt;Simply put, Connector queues are used for cross-platform messaging. For a detailed guide on how this works, refer to the documentation &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms706915(v=vs.85).aspx&#34;&gt;on MSDN&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&#34;outgoing-queues&#34;&gt;Outgoing Queues&lt;/h4&gt;

&lt;p&gt;Outgoing queues are local internal queues that are used to store messages sent to remote queues. Messages can be stored in outgoing queues under off-line conditions and then sent to target queues on remote computers when connectivity is restored. These queues are generated automatically and cannot be created or deleted manually.&lt;/p&gt;

&lt;h2 id=&#34;creating-an-msmq-message-queue&#34;&gt;Creating an MSMQ Message Queue&lt;/h2&gt;

&lt;p&gt;After you have installed MSMQ, you  can access the control panel for MSMQ by opening &lt;code&gt;Computer Management &amp;gt; Services and Applications &amp;gt; Message Queuing&lt;/code&gt;. From here you can see the four types of queue available within MSMQ as well as the MSMQ triggers (if you installed the triggers):&lt;/p&gt;

&lt;h2 id=&#34;accessing-an-msmq-message-queue&#34;&gt;Accessing an MSMQ Message Queue&lt;/h2&gt;

&lt;p&gt;In order to access a message queue, you need to add a reference &lt;code&gt;System.Messaging&lt;/code&gt;. This will provide you access to the &lt;code&gt;MessageQueue&lt;/code&gt; class. If you know the path, format name or label you can use &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ch1d814t(v=vs.110).aspx&#34;&gt;the following constructor overload&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var mq = new MessageQueue(pathOrFormatOrLabel);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The path name can be in the following &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms706083(v=vs.85).aspx&#34;&gt;syntax&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var mq = new MessageQueue(@&amp;quot;ComputerName\QueueName&amp;quot;);
var mq = new MessageQueue(@&amp;quot;ComputerName\PRIVATE$\QueueName&amp;quot;);
var mq = new MessageQueue(@&amp;quot;.\QueueName&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The period shown in the last example is a common computer representation of the local computer.&lt;/p&gt;

&lt;p&gt;In order to reference a queue by its label, the string must start with &lt;code&gt;Label:&lt;/code&gt; followed by the name of the queue. For example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var mq = new MessageQueue(&amp;quot;Label:TestQueue&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lastly, accessing a queue via its GUID requires the following format `FormatName:Modifier=GUID&amp;rdquo;, for example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var mq = new MessageQueue(&amp;quot;FormatName:Public=5A5F7535-AE9A-41d4-935C-845C2AFF7112&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Dead letter queues, computer journals and queue journals can all be monitored by using the following paths:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var mq = new MessageQueue(@&amp;quot;.\DeadLetter$&amp;quot;); // Non-transactional Dead Letter Queue
var mq = new MessageQueue(@&amp;quot;.\XactDeadLetter$&amp;quot;); // Transactional Dead Letter Queue 
var mq = new MessageQueue(@&amp;quot;.\Journal$&amp;quot;); // Computer Journal
var mq = new MessageQueue(@&amp;quot;.\TestQueue\Journal$&amp;quot;); // Queue Journal                
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;sending-a-message-to-an-msmq-message-queue&#34;&gt;Sending a message to an MSMQ Message Queue&lt;/h2&gt;

&lt;p&gt;In order to send a message to a message queue, you need to know how to access the queue as described above. Next you need to create an instance of the &lt;code&gt;MessageQueue&lt;/code&gt; class using one of the following &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/System.Messaging.MessageQueue.MessageQueue(v=vs.110).aspx&#34;&gt;MessageQueue constructors&lt;/a&gt;. The &lt;code&gt;MessageQueue&lt;/code&gt; class inherits from Component, which implements &lt;code&gt;IDisposable&lt;/code&gt;, allowing us to cleanly free the resources of the queue by using a &lt;code&gt;using&lt;/code&gt; statement:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once the queue has been created, we should check that we can write to the queue by using the &lt;code&gt;CanWrite&lt;/code&gt; property:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
    if(mq.CanWrite)
    {
    }
    else
    {
        // we cannot write to the queue
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then we can create an instance of the &lt;code&gt;Message&lt;/code&gt; class and call the &lt;code&gt;Send&lt;/code&gt; method on the message queue to send our message:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
    if(mq.CanWrite)
    {
        var msg = new Message(&amp;quot;Hello world&amp;quot;);
        mq.Send(msg);           
    }
    else
    {
        // we cannot write to the queue
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;sending-a-message-to-an-msmq-message-queue-using-transactions&#34;&gt;Sending a message to an MSMQ Message Queue using transactions&lt;/h3&gt;

&lt;p&gt;Sometimes we will be required to send messages to a transactional queue. We can extend our previous example to include a check on the &lt;code&gt;Transactional&lt;/code&gt; property:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
    if(mq.CanWrite)
    {
        var msg = new Message(&amp;quot;Hello world&amp;quot;);
        if(mq.Transactional)
        {
        }
        else
        {   
            mq.Send(msg);
        }                       
    }
    else
    {
        // we cannot write to the queue
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here I have branched out the original code into the else branch to compare. Next, we should construct a &lt;code&gt;MessageQueueTransaction&lt;/code&gt; object which in turn can be passed to the &lt;code&gt;Send&lt;/code&gt; method. Before we call the &lt;code&gt;Send&lt;/code&gt; method, we need to ensure that we have called the &lt;code&gt;Begin&lt;/code&gt; method on the transaction object, and &lt;code&gt;Commit&lt;/code&gt; when we have completed. This will ensure that MSMQ will use the correct transactional semantics:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
    if(mq.CanWrite)
    {
        var msg = new Message(&amp;quot;Hello world&amp;quot;);
        if(mq.Transactional)
        {
            var transaction = new MessageQueueTransaction();
            transaction.Begin();
            mq.Send(msg, transaction);
            transaction.Commit();
        }
        else
        {   
            mq.Send(msg);
        }                       
    }
    else
    {
        // we cannot write to the queue
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;retrieving-a-message-from-an-msmq-message-queue&#34;&gt;Retrieving a message from an MSMQ Message Queue&lt;/h2&gt;

&lt;p&gt;In order to retrieve a message from a message queue, you need to know how to access the queue as described above. Next you need to create an instance of the &lt;code&gt;MessageQueue&lt;/code&gt; class using one of the following &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/System.Messaging.MessageQueue.MessageQueue(v=vs.110).aspx&#34;&gt;MessageQueue constructors&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{    
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once the queue has been created, we should check that we can read from the queue by using the &lt;code&gt;CanRead&lt;/code&gt; property:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
    if(mq.CanRead)
    {
    }
    else
    {
        // we can not receive from the queue
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;From here, it is a case of calling the &lt;code&gt;Receive&lt;/code&gt; method and processing the result:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
    if(mq.CanRead)
    {
        var msg = mq.Receive();
        // do something with the received message
    }
    else
    {
        // we can not receive from the queue
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;You may have to set the &lt;code&gt;Formatter&lt;/code&gt; property as shown &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/y918yfy2(v=vs.110).aspx&#34;&gt;here&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;retrieving-a-message-from-an-msmq-message-queue-using-transactions&#34;&gt;Retrieving a message from an MSMQ Message Queue using transactions&lt;/h3&gt;

&lt;p&gt;Similarly to the transactional code we used when sending a message, we can inspect the &lt;code&gt;Transactional&lt;/code&gt; property on the &lt;code&gt;MessageQueue&lt;/code&gt; before creating a &lt;code&gt;MessageQueueTransaction&lt;/code&gt; object, passing it to the &lt;code&gt;Receive&lt;/code&gt; method:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;using(var mq = new MessageQueue(&amp;quot;.\TestQueue&amp;quot;))
{
    if(mq.CanRead)
    {
        if(mq.Transactional)
        {
            var transaction = new MessageQueueTransaction();
            transaction.Begin();
            mq.Receive(transaction);
            transaction.Commit();               
        }
        else
        {
            var msg = mq.Receive();
            // do something with the received message
        }
    }
    else
    {
        // we can not receive from the queue
    }
}
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Message Queue Fundementals: Introduction</title>
      <link>https://im5tu.io/article/2014/09/message-queue-fundementals-introduction/</link>
      <pubDate>Sun, 07 Sep 2014 18:35:37 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/09/message-queue-fundementals-introduction/</guid>
      <description>&lt;p&gt;Message queues are a substantial part of modern day enterprise architectures and a vital part of providing scalable solutions. They are designed for asynchronous communication between different parts of the system. They help scale individual components of a system and increase reliability with the optional addition of the persistence of messages to a storage system.&lt;/p&gt;

&lt;p&gt;In the next few articles I will be covering some of the basics of message queues followed by a couple of different implementations including &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms711472(v=vs.85).aspx&#34;&gt;Microsoft&amp;rsquo;s MSMQ&lt;/a&gt; and &lt;a href=&#34;http://particular.net/&#34;&gt;Particular&amp;rsquo;s&lt;/a&gt; &lt;a href=&#34;http://particular.net/nservicebus&#34;&gt;NServiceBus&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;what-is-a-message-queue-mq&#34;&gt;What is a Message Queue (MQ)?&lt;/h2&gt;

&lt;p&gt;Messages queues can be thought of as any other first-in-first-out queue. Each message queue accepts a single message one at a time and stores it until a handler is ready to process this message. If there are no message handlers ready to receive the message, it remains in the queue. Some implementations of message queues allow the configuration of features such as a priority on each message, others do not.&lt;/p&gt;

&lt;p&gt;As mentioned earlier, message queues are designed to perform asynchronous communication which they achieve in one of three principals:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Fire &amp;amp; Forget&lt;/li&gt;
&lt;li&gt;Request-Response&lt;/li&gt;
&lt;li&gt;Publish/Subscribe&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;I will also detail a variant of the Request-Response pattern called Scatter-Gather and an additional technique of the Publish/Subscribe pattern called Subscription Filters.&lt;/p&gt;

&lt;h2 id=&#34;fire-forget-messaging&#34;&gt;Fire &amp;amp; Forget Messaging&lt;/h2&gt;

&lt;p&gt;Originally a military term, the phrase fire and forget has ported well to realms of programming. Typically when two entities are communicating, one entity sends a message and the other replies (be it (a)synchronously). With fire &amp;amp; forget messaging, the entity is not interested in any reply, simply the acknowledgement of the message.&lt;/p&gt;

&lt;p&gt;The best example I can think of is notifications. Once the application server has sent the notification message to the message queue, it is free to process additional requests. When a handler is free to pick up the notification message it does and sends the message on to the relevant device via the correct medium. At any stage during, the only response is acknowledgement of receipt of the notification message. This is so that the queues do not attempt to resend the message. If an error occurs, or a time-out value expires, the message is left in the queue to be tried again, depending on the nature of the error.&lt;/p&gt;

&lt;h2 id=&#34;request-reponse-messaging&#34;&gt;Request-Reponse Messaging&lt;/h2&gt;

&lt;p&gt;In request-response, two different queues are used; one for processing requests and the other for processing the responses. Whilst sending the message to the request queue, the client often includes a reply address so that a response can be sent to the correct destination.&lt;/p&gt;

&lt;p&gt;Each client typically has its own response queue, so that it only receives responses to its own requests. This pattern of messaging allows the client to continue processing while it waits for a response from the response queue, which would have otherwise been completed via synchronous communication.&lt;/p&gt;

&lt;h3 id=&#34;scatter-gather-messaging&#34;&gt;Scatter-Gather Messaging&lt;/h3&gt;

&lt;p&gt;Often responses are required from multiple sources. This is where the Scatter-Gather pattern comes in. The Scatter-Gather pattern is a composition of the publish-subcribe pattern that we will see later and the aggregator pattern. Once a message has been published, the subscribers return the responses to a central queue to be consumed by an aggregator.&lt;/p&gt;

&lt;p&gt;The aggregator will know how many responses it should expect, either by using a pre-defined value or via header information. Once the aggregation is complete, the publisher is notified via the response message queue.&lt;/p&gt;

&lt;p&gt;In this scenario, I would typically expect to see three distinct queues:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;A publisher queue&lt;/li&gt;
&lt;li&gt;An aggregation queue&lt;/li&gt;
&lt;li&gt;A response queue&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;publish-subscribe-messaging&#34;&gt;Publish/Subscribe Messaging&lt;/h2&gt;

&lt;p&gt;The publish/subscribe pattern is not to dissimilar to the observer pattern found in C#/Java. Interested parties subscribe to a specific queue in order to receive notifications. Once a message has been sent to the queue, all parties receive a copy of the message.&lt;/p&gt;

&lt;p&gt;This pattern is good for event-driven processing, since components can be added or removed with relative ease. An example would be a users address changes. The changes need to be reflected in the database, a CRM system and a third party provider. Without this pattern, the publisher would have to know about the three different systems in order to complete the processing. Instead, the publisher only knows about the queue, and the queue about the subscribers to that queue.&lt;/p&gt;

&lt;p&gt;A natural extension of this pattern is the &lt;a href=&#34;http://msdn.microsoft.com/en-gb/data/gg577609.aspx&#34;&gt;Reactive Extensions Framework (Rx)&lt;/a&gt;. It is a library for composing asynchronous and event-based programs using observable sequences and LINQ-style query operators and has been ported to many different languages.&lt;/p&gt;

&lt;h3 id=&#34;subscription-filters&#34;&gt;Subscription Filters&lt;/h3&gt;

&lt;p&gt;Subscription filters can be applied to any queue that contains a publish-subscribe model. Upon receipt of a message, the queue is responsible for deciding which messages should be sent to each handler. This allows for greater security, because not all subscribers receive all messages, but at the cost of greater processing expense. The addition of each new subscriber will impact the throughput of the queue because the new subscriber has to be considered for every message that flows through the queue.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Finding Reducible Expressions</title>
      <link>https://im5tu.io/article/2014/06/finding-reducible-expressions/</link>
      <pubDate>Tue, 24 Jun 2014 09:21:19 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/06/finding-reducible-expressions/</guid>
      <description>&lt;p&gt;Today I just wanted to share a quick note regarding &lt;a href=&#34;http://stackoverflow.com/a/2040097/315711&#34;&gt;a Stack Overflow answer&lt;/a&gt; that I recently came across. In the answer the author explains that a call to &lt;code&gt;Expression.CanReduce&lt;/code&gt; will typically return false, while &lt;code&gt;Expression.Reduce()&lt;/code&gt; will return the current expression. The author continues to state that one of the types that overrides &lt;code&gt;Expression.Reduce()&lt;/code&gt; and &lt;code&gt;Expression.CanReduce&lt;/code&gt; is &lt;code&gt;MemberInitExpression&lt;/code&gt;.
&lt;/p&gt;

&lt;p&gt;I wanted to find out when &lt;code&gt;Expression.CanReduce&lt;/code&gt; would actually return &lt;code&gt;true&lt;/code&gt;. I discovered the &lt;a href=&#34;http://www.codeplex.com/Download?ProjectName=dlr&amp;amp;DownloadId=246540&#34;&gt;173 page Expression Tree Specification&lt;/a&gt; which provides an additional insight to &lt;code&gt;CanReduce&lt;/code&gt; and &lt;code&gt;Reduce()&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;canreduce&#34;&gt;CanReduce&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;This property returns whether the Reduce method returns a different but semantically equivalent ET.  By default, this property returns false.&lt;/p&gt;

&lt;p&gt;In the typical case, the resulting ET contains all common ET nodes suitable for passing to any common compilation or ET processing code.  Sometimes the result is only partially reduced, and when walking the resulting ET, you&amp;rsquo;ll need to further reduce some nodes.&lt;/p&gt;

&lt;p&gt;The value returned by this property should never change for a given object.&lt;/p&gt;

&lt;p&gt;Signature:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;pre&gt;&lt;code&gt;public virtual Boolean CanReduce { get; }
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;reduce&#34;&gt;Reduce&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;This method returns a semantically equivalent ET representing the same expression.  By default, this method returns the object on which it was invoked.&lt;/p&gt;

&lt;p&gt;Typically the result comprises only common ET types, ET nodes suitable for passing to any compilation or ET processing code.  Usually the result is only partially reduced (that is, only the root node).  You&amp;rsquo;ll probably need to further reduce some nodes.&lt;/p&gt;

&lt;p&gt;Signature:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;pre&gt;&lt;code&gt;public virtual Expression Reduce();
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;reducible-types-inside-system-linq-expressions&#34;&gt;Reducible Types Inside System.Linq.Expressions&lt;/h3&gt;

&lt;p&gt;Using &lt;a href=&#34;http://www.telerik.com/products/decompiler.aspx&#34;&gt;Telerik&amp;rsquo;s JustDecompile&lt;/a&gt;, I went through each public class to see which had an override on either &lt;code&gt;CanReduce&lt;/code&gt; or &lt;code&gt;Reduce()&lt;/code&gt;. The result came up with the following list:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.linq.expressions.binaryexpression.aspx&#34;&gt;BinaryExpression&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.linq.expressions.listinitexpression.aspx&#34;&gt;ListInitExpression&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-GB/library/system.linq.expressions.memberinitexpression.aspx&#34;&gt;MemberInitExpression&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.linq.expressions.unaryexpression.aspx&#34;&gt;UnaryExpression&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Furthermore, I searched for descendant types of the list above and found the following reducible classes that were marked as internal, as such I couldn&amp;rsquo;t find any official documentation for them:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;AssignBinaryExpression&lt;/li&gt;
&lt;li&gt;CoalesceConversionBinaryExpression&lt;/li&gt;
&lt;li&gt;LogicalBinaryExpression&lt;/li&gt;
&lt;li&gt;SimpleBinaryExpression&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;further-reading&#34;&gt;Further Reading&lt;/h3&gt;

&lt;p&gt;Inside the expression tree specification, I would also be inclined to read section 2.2 entitled &lt;em&gt;Reducible Nodes&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;If there are any additional expressions that can be reduced that I have missed, please send me a message and I will add it to the list.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>How your binary search implementation is broken and how to fix it</title>
      <link>https://im5tu.io/article/2014/06/how-your-binary-search-implementation-is-broken-and-how-to-fix-it/</link>
      <pubDate>Fri, 20 Jun 2014 18:21:04 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/06/how-your-binary-search-implementation-is-broken-and-how-to-fix-it/</guid>
      <description>&lt;p&gt;I have recently begun studying the theory and implementations of algorithms. During this study, I came across &lt;a href=&#34;http://googleresearch.blogspot.co.uk/2006/06/extra-extra-read-all-about-it-nearly.html&#34;&gt;this post&lt;/a&gt; which describes how a bug exists in most implementations of a binary search algorithm. &lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ll begin with the example given in the post, which is taken from &lt;code&gt;java.util.Arrays&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;public static int BinarySearch(int[] a, int key) {
    int low = 0;
    int high = a.length - 1;
    while (low &amp;lt;= high) {
        int mid = (low + high) / 2;
        int midVal = a[mid];
        if (midVal &amp;lt; key)
        {
            low = mid + 1;
        }
        else if (midVal &amp;gt; key)
        {
            high = mid - 1;
        }
        else
        {
            return mid; // key found
        }
    }
    return -(low + 1);  // key not found.
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;For all intensive purposes this implementation is correct. Except for a bug which can raise an Overflow Exception. The problematic line is this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;int mid = (low + high) / 2;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If the result of &lt;code&gt;low + high&lt;/code&gt; is greater than maximum value of an 32-bit integer, the exception is raised. Luckily, there are ways that we can fix this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;int mid = low + (high - low) / 2;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or if you&amp;rsquo;re in Java:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;int mid = (low + high) &amp;gt;&amp;gt;&amp;gt; 1;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you are working in .Net languages you will need to work with the &lt;code&gt;unchecked&lt;/code&gt; keyword in order to use the bit shift method:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;int mid;
unchecked
{
    mid = (low + high) &amp;gt;&amp;gt; 1;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;The &lt;code&gt;unchecked&lt;/code&gt; keyword is used to suppress overflow-checking for integral-type arithmetic operations and conversions.&lt;/p&gt;

&lt;p&gt;In an unchecked context, if an expression produces a value that is outside the range of the destination type, the overflow is not flagged. For example, because the calculation in the following example is performed in an unchecked block or expression, the fact that the result is too large for an integer is ignored, and int1 is assigned the value -2,147,483,639.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;(&lt;a href=&#34;http://msdn.microsoft.com/en-GB/library/a569z7k8.aspx&#34;&gt;Source&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;So here is the differential method in C#:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;public static int BinarySearch(int[] a, int key) {
    int low = 0;
    int high = a.length - 1;
    while (low &amp;lt;= high) {
        int mid = low + (high - low) / 2;
        int midVal = a[mid];
        if (midVal &amp;lt; key)
        {
            low = mid + 1;
        }
        else if (midVal &amp;gt; key)
        {
            high = mid - 1;
        }
        else
        {
            return mid; // key found
        }
    }
    return -1;  // key not found.
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And using the bit shift method:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;public static int BinarySearch(int[] a, int key) {
    int low = 0;
    int high = a.length - 1;
    while (low &amp;lt;= high) {
        int mid;
        unchecked
        {
            mid = (low + high) &amp;gt;&amp;gt; 1;
        }
        int midVal = a[mid];
        if (midVal &amp;lt; key)
        {
            low = mid + 1;
        }
        else if (midVal &amp;gt; key)
        {
            high = mid - 1;
        }
        else
        {
            return mid; // key found
        }
    }
    return -1;  // key not found.
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Personally, I prefer the differential version over the bit shift version but I have provided both for completeness. Even though this bug only manifests itself with well over a billion elements in an array, I still thought it was worth pointing out. I encourage you to read the other articles for more complete context.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Unit Testing Equals The Forgotten Tests</title>
      <link>https://im5tu.io/article/2014/06/unit-testing-equals-the-forgotten-tests/</link>
      <pubDate>Wed, 18 Jun 2014 18:20:25 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/06/unit-testing-equals-the-forgotten-tests/</guid>
      <description>&lt;p&gt;Today I wanted to cover something that is not often covered when unit testing an object. If an object has the &lt;code&gt;Equals&lt;/code&gt; method overridden, then there are a number of tests that we should be running as a minimum, these are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Reflexive Tests&lt;/li&gt;
&lt;li&gt;Symmetric Tests&lt;/li&gt;
&lt;li&gt;Transitive Tests&lt;/li&gt;
&lt;li&gt;Consistency Tests&lt;/li&gt;
&lt;li&gt;Not-Null Tests&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;reflexive-tests&#34;&gt;Reflexive Tests&lt;/h3&gt;

&lt;p&gt;A reflexive test is one where an object is equal to itself. In other words, the following expression should be true: &lt;code&gt;x.Equals(x)&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Test]
public void ReflexiveTest()
{
    var x = new TestClass();

    Assert.IsTrue(x.Equals(x));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;symmetric-tests&#34;&gt;Symmetric Tests&lt;/h3&gt;

&lt;p&gt;A symmetric test is one where an object (&lt;code&gt;x&lt;/code&gt;) is equal to another instance (&lt;code&gt;y&lt;/code&gt;), only if the second instance (&lt;code&gt;y&lt;/code&gt;) is also equal to the first instance (&lt;code&gt;x&lt;/code&gt;). In essence, if &lt;code&gt;x.Equals(y)&lt;/code&gt; then &lt;code&gt;y.Equals(x)&lt;/code&gt; should also be true.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Test]
public void SymmetricTest()
{
    var x = new TestClass();
    var y = new TestClass();

    Assert.IsTrue(x.Equals(y));
    Assert.IsTrue(y.Equals(x));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;transitive-tests&#34;&gt;Transitive Tests&lt;/h3&gt;

&lt;p&gt;A transitive tests is one where if object &lt;code&gt;x&lt;/code&gt; is equal to &lt;code&gt;y&lt;/code&gt;, and &lt;code&gt;y&lt;/code&gt; is equal to &lt;code&gt;z&lt;/code&gt;, then &lt;code&gt;x&lt;/code&gt; should also be equal to &lt;code&gt;z&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Test]
public void TransitiveTest()
{
    var x = new TestClass();
    var y = new TestClass();
    var z = new TestClass();

    Assert.IsTrue(x.Equals(y));
    Assert.IsTrue(y.Equals(z));
    Assert.IsTrue(x.Equals(z));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;consistency-tests&#34;&gt;Consistency Tests&lt;/h3&gt;

&lt;p&gt;A consistent test should ensure that regardless of how many invocations of the &lt;code&gt;Equals&lt;/code&gt; method occurs, the result should remain the same. For example, both of the following tests should pass:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Test]
public void ConsistencyTest_2Invocations()
{
    var x = new TestClass();
    var y = new TestClass();

    Assert.IsTrue(x.Equals(y));
    Assert.IsTrue(x.Equals(y));
}

[Test]
public void ConsistencyTest_3Invocations()
{
    var x = new TestClass();
    var y = new TestClass();

    Assert.IsTrue(x.Equals(y));
    Assert.IsTrue(x.Equals(y));
    Assert.IsTrue(x.Equals(y));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;not-null-tests&#34;&gt;Not-Null Tests&lt;/h3&gt;

&lt;p&gt;If the &lt;code&gt;Equals&lt;/code&gt; method is called with a null argument, the result of the test should always be &lt;code&gt;false&lt;/code&gt;. This is because an instance of an object is never equal to a null reference.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Test]
public void NullTest()
{
    var x = new TestClass();

    Assert.IsFalse(x.Equals(null));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;other-notes-about-overriding-equals&#34;&gt;Other notes about overriding Equals&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;If you override &lt;code&gt;Equals()&lt;/code&gt;, ensure that you override &lt;code&gt;GetHashCode()&lt;/code&gt; as well.

&lt;ul&gt;
&lt;li&gt;If two objects are equal, then they must return the same value for &lt;code&gt;GetHashCode()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If &lt;code&gt;GetHashCode()&lt;/code&gt; is equal, it is not necessary for them to be the same; this is a collision and &lt;code&gt;Equals()&lt;/code&gt; should be called to see if the objects are equal in reality&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;If possible, always implement the &lt;code&gt;IEquatable&amp;lt;T&amp;gt;&lt;/code&gt; interface on your custom objects as this provides type safety for other programmers and prevents boxing on value-types.&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>Enabling HTTP Strict Transport Security HSTS via Web Config</title>
      <link>https://im5tu.io/article/2014/06/enabling-http-strict-transport-security-hsts-via-web-config/</link>
      <pubDate>Tue, 10 Jun 2014 18:19:47 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/06/enabling-http-strict-transport-security-hsts-via-web-config/</guid>
      <description>&lt;p&gt;In my previous post, I discussed how to &lt;a href=&#34;https://im5tu.io/article/2014/04/21/Enabling-HTTP-Strict-Transport-Security-HSTS-via-ASP-Net-MVC-ActionFilters/&#34;&gt;enable HSTS via MVC Action Filters&lt;/a&gt;. I thought that I would just do a follow up post showing you how to enable it via the web.config. &lt;/p&gt;

&lt;p&gt;In order to do this via a web configuration file, you must be running IIS 7.0 or higher, &lt;a href=&#34;http://www.iis.net/configreference/system.webserver/httpprotocol/customheaders#002&#34;&gt;according to this compatability chart&lt;/a&gt;. The reason for this, is that the &lt;code&gt;HttpProtocol&lt;/code&gt; element was added in IIS 7.0. This is the element that is responsible for generating custom headers.&lt;/p&gt;

&lt;p&gt;Below is a small sample configuration that enables a custom header called &lt;code&gt;Header Name&lt;/code&gt; with the value &lt;code&gt;Header Value&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;configuration&amp;gt;
  &amp;lt;system.webServer&amp;gt;
    &amp;lt;httpProtocol&amp;gt;
      &amp;lt;customHeaders&amp;gt;
        &amp;lt;add name=&amp;quot;Header Name&amp;quot; value=&amp;quot;Header Value&amp;quot; /&amp;gt;
      &amp;lt;/customHeaders&amp;gt;
    &amp;lt;/httpProtocol&amp;gt;
  &amp;lt;/system.webServer&amp;gt;
&amp;lt;/configuration&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In order to enable HSTS, we need to change the header name to be &lt;code&gt;Strict-Transport-Security&lt;/code&gt; and the value to be &lt;code&gt;max-age=x&lt;/code&gt; (where x is, replace with the maximum age in seconds). If you wish to enable this for sub-domains as well, append &lt;code&gt;; includeSubDomains&lt;/code&gt; to the header value.&lt;/p&gt;

&lt;p&gt;The end result for enabling HSTS with a 300 second limit is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;configuration&amp;gt;
  &amp;lt;system.webServer&amp;gt;
    &amp;lt;httpProtocol&amp;gt;
      &amp;lt;customHeaders&amp;gt;
        &amp;lt;add name=&amp;quot;Strict-Transport-Security&amp;quot; value=&amp;quot;max-age=300&amp;quot; /&amp;gt;
      &amp;lt;/customHeaders&amp;gt;
    &amp;lt;/httpProtocol&amp;gt;
  &amp;lt;/system.webServer&amp;gt;
&amp;lt;/configuration&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Including the sub-domain protection:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;configuration&amp;gt;
  &amp;lt;system.webServer&amp;gt;
    &amp;lt;httpProtocol&amp;gt;
      &amp;lt;customHeaders&amp;gt;
        &amp;lt;add name=&amp;quot;Strict-Transport-Security&amp;quot; value=&amp;quot;max-age=300; includeSubDomains&amp;quot; /&amp;gt;
      &amp;lt;/customHeaders&amp;gt;
    &amp;lt;/httpProtocol&amp;gt;
  &amp;lt;/system.webServer&amp;gt;
&amp;lt;/configuration&amp;gt;
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Enabling HTTP Strict Transport Security HSTS via ASP Net MVC ActionFilters</title>
      <link>https://im5tu.io/article/2014/04/enabling-http-strict-transport-security-hsts-via-asp-net-mvc-actionfilters/</link>
      <pubDate>Mon, 21 Apr 2014 18:19:47 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/04/enabling-http-strict-transport-security-hsts-via-asp-net-mvc-actionfilters/</guid>
      <description>&lt;p&gt;After reading &lt;a href=&#34;http://www.troyhunt.com/&#34;&gt;Troy Hunt&amp;rsquo;s&lt;/a&gt; free ebook on the &lt;a href=&#34;http://www.troyhunt.com/2011/12/free-ebook-owasp-top-10-for-net.html&#34;&gt;OWASP Top 10 for .Net Developers&lt;/a&gt;, I discovered an additional mechanism to help developers secure their websites. That mechanism is HTTP Strict Transport Security.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;HTTP Strict Transport Security (HSTS) is an opt-in security enhancement that is specified by a web application through the use of a special response header. Once a supported browser receives this header that browser will prevent any communications from being sent over HTTP to the specified domain and will instead send all communications over HTTPS. It also prevents HTTPS click through prompts on browsers. The specification has been released and published end of 2012 as &lt;a href=&#34;https://tools.ietf.org/html/rfc6797&#34;&gt;RFC 6797&lt;/a&gt;. &lt;a href=&#34;https://www.owasp.org/index.php/HTTP_Strict_Transport_Security&#34;&gt;Source&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There are three main categories of attacks that are addressed in this specification: Passive Network Attacks, Active Network Attacks and Web Site Development &amp;amp; Deployment Bugs. These are present in &lt;a href=&#34;https://tools.ietf.org/html/rfc6797&#34;&gt;RFC 6797 - Section 2.3.1&lt;/a&gt; but are re-produced here.&lt;/p&gt;

&lt;h2 id=&#34;passive-network-attacks&#34;&gt;Passive Network Attacks&lt;/h2&gt;

&lt;blockquote&gt;
&lt;p&gt;When a user browses the web on a local wireless network (e.g., an
   802.11-based wireless local area network) a nearby attacker can
   possibly eavesdrop on the user&amp;rsquo;s unencrypted Internet Protocol-based
   connections, such as HTTP, regardless of whether or not the local
   wireless network itself is secured [BeckTews09].  Freely available
   wireless sniffing toolkits (e.g., [Aircrack-ng]) enable such passive
   eavesdropping attacks, even if the local wireless network is
   operating in a secure fashion.  A passive network attacker using such
   tools can steal session identifiers/cookies and hijack the user&amp;rsquo;s web
   session(s) by obtaining cookies containing authentication credentials
   [ForceHTTPS].  For example, there exist widely available tools, such
   as Firesheep (a web browser extension) [Firesheep], that enable their
   wielder to obtain other local users&amp;rsquo; session cookies for various web
   applications.&lt;/p&gt;

&lt;p&gt;To mitigate such threats, some web sites support, but usually do not
   force, access using end-to-end secure transport &amp;ndash; e.g., signaled
   through URIs constructed with the &amp;ldquo;https&amp;rdquo; scheme [RFC2818].  This can
   lead users to believe that accessing such services using secure
   transport protects them from passive network attackers.
   Unfortunately, this is often not the case in real-world deployments,
   as session identifiers are often stored in non-Secure cookies to
   permit interoperability with versions of the service offered over
   insecure transport (&amp;ldquo;Secure cookies&amp;rdquo; are those cookies containing the
   &amp;ldquo;Secure&amp;rdquo; attribute [RFC6265]).  For example, if the session
   identifier for a web site (an email service, say) is stored in a
   non-Secure cookie, it permits an attacker to hijack the user&amp;rsquo;s
   session if the user&amp;rsquo;s UA makes a single insecure HTTP request to the
   site.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;active-network-attacks&#34;&gt;Active Network Attacks&lt;/h2&gt;

&lt;blockquote&gt;
&lt;p&gt;A determined attacker can mount an active attack, either by
   impersonating a user&amp;rsquo;s DNS server or, in a wireless network, by
   spoofing network frames or offering a similarly named evil twin
   access point.  If the user is behind a wireless home router, an
   attacker can attempt to reconfigure the router using default
   passwords and other vulnerabilities.  Some sites, such as banks, rely
   on end-to-end secure transport to protect themselves and their users
   from such active attackers.  Unfortunately, browsers allow their
   users to easily opt out of these protections in order to be usable for sites that incorrectly deploy secure transport, for example by
   generating and self-signing their own certificates (without also
   distributing their certification authority (CA) certificate to their
   users&amp;rsquo; browsers).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;website-development-deployment-bugs&#34;&gt;Website Development &amp;amp; Deployment Bugs&lt;/h2&gt;

&lt;blockquote&gt;
&lt;p&gt;The security of an otherwise uniformly secure site (i.e., all of its
   content is materialized via &amp;ldquo;https&amp;rdquo; URIs) can be compromised
   completely by an active attacker exploiting a simple mistake, such as
   the loading of a cascading style sheet or a SWF (Shockwave Flash)
   movie over an insecure connection (both cascading style sheets and
   SWF movies can script the embedding page, to the surprise of many web
   developers, plus some browsers do not issue so-called &amp;ldquo;mixed content
   warnings&amp;rdquo; when SWF files are embedded via insecure connections).
   Even if the site&amp;rsquo;s developers carefully scrutinize their login page
   for &amp;ldquo;mixed content&amp;rdquo;, a single insecure embedding anywhere on the
   overall site compromises the security of their login page because an
   attacker can script (i.e., control) the login page by injecting code
   (e.g., a script) into another, insecurely loaded, site page.&lt;/p&gt;

&lt;p&gt;NOTE:  &amp;ldquo;Mixed content&amp;rdquo; as used above (see also Section 5.3 in
          [W3C.REC-wsc-ui-20100812]) refers to the notion termed &amp;ldquo;mixed
          security context&amp;rdquo; in this specification and should not be
          confused with the same &amp;ldquo;mixed content&amp;rdquo; term used in the
          context of markup languages such as XML and HTML.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;implementation-details&#34;&gt;Implementation Details&lt;/h2&gt;

&lt;p&gt;Implementing the HSTS from the web server is simply a case of having the site running over HTTPS and appending a single header onto the response. The header required is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Strict-Transport-Security: max-age=300
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Alternatively, if you wish the security to cover all sub-domains of your site, then the header is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Strict-Transport-Security: max-age=300; includeSubDomains
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;Where 300 is, replace with the duration in seconds.&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&#34;implementing-hsts-as-an-action-filter&#34;&gt;Implementing HSTS as an action filter&lt;/h2&gt;

&lt;p&gt;The implementation that I provide below &lt;strong&gt;SHOULD&lt;/strong&gt; be used alongside the &lt;code&gt;RequireHttpsAttribute&lt;/code&gt; in order to have the specification fully implemented. The reason is that the header will only be sent over a secure connection, if not already present. Furthermore, the &lt;code&gt;RequireHttpsAttribute&lt;/code&gt; already takes care of the redirection to a secure connection, so this is not something that I have to worry about implementing correctly.&lt;/p&gt;

&lt;h2 id=&#34;browser-support&#34;&gt;Browser support&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Chromium and Google Chrome since version 4.0.211.0&lt;/li&gt;
&lt;li&gt;Firefox since version 4; with Firefox 17, Mozilla integrates a list of websites supporting HSTS&lt;/li&gt;
&lt;li&gt;Opera since version 12&lt;/li&gt;
&lt;li&gt;Safari as of OS X Mavericks
-Internet Explorer does not support HSTS, but is expected to support it in the next major release after IE 11&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>SAP Business One V9 Version Strings</title>
      <link>https://im5tu.io/article/2014/03/sap-business-one-v9-version-strings/</link>
      <pubDate>Sat, 15 Mar 2014 13:18:01 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2014/03/sap-business-one-v9-version-strings/</guid>
      <description>&lt;p&gt;Today I had to figure out what the current version of SAP Business One is. In order to do this, I looked at the table SFMD inside of SBO-Common and found the following results:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Version |   Patch Level
-----------------------
900046  |   00
900052  |   01
900053  |   01 Hotfix 1
900055  |   03
900056  |   04
900058  |   06
900059  |   07
900060  |   08
902000  |   09
902001  |   09 Hotfix 1
902002  |   10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;Note: I added the Hotfix 1 to clarify. I believe these are correct, I can&amp;rsquo;t find a definitive source to verify these results.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Then in order to check the target databases version, I ran the following against the target database:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;SELECT [Version] FROM [CINF]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There might be a better way of doing this. This article proposes a single solution. If you have an alternative solution, please notify me through social media.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Becoming An MCP</title>
      <link>https://im5tu.io/article/2013/06/becoming-an-mcp/</link>
      <pubDate>Mon, 10 Jun 2013 20:14:39 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2013/06/becoming-an-mcp/</guid>
      <description>&lt;p&gt;As the title suggests, today I passed the 70-483 Programming in C# exam to offically become a Microsoft Certifed Professional.
&lt;/p&gt;

&lt;p&gt;This is one of the things that has been in my sights for a very long time now, so I am extremly happy to have passed. I throughly recommend doing it for yourself if you haven&amp;rsquo;t done so already. I know exams aren&amp;rsquo;t everyones cup of tea, but even if you decide not to take the exam, I believe that the knownledge you gain during the study phase will prove invaluable to your day to day work.&lt;/p&gt;

&lt;p&gt;Since I already had 5 years programming experience with the .Net environment, the exam was mainly a tick in the box. That said, I would throughly recommend you read the &lt;a href=&#34;http://www.amazon.co.uk/CLR-via-Developer-Reference-ebook/dp/B00AA36R4U/ref=tmm_kin_title_0/277-8084778-0056569&#34;&gt;CLR via C# Forth Edition&lt;/a&gt;. The book gives a fantasic insight into the inner workings of the CLR and why some features are not supported by C#.&lt;/p&gt;

&lt;p&gt;I wish you all the best of luck if you decide to take this exam.&lt;/p&gt;

&lt;p&gt;Stu&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Using IDisposible correctly</title>
      <link>https://im5tu.io/article/2013/05/using-idisposible-correctly/</link>
      <pubDate>Mon, 06 May 2013 18:09:25 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2013/05/using-idisposible-correctly/</guid>
      <description>&lt;p&gt;In this article, I am going to show you how to use the &lt;code&gt;IDisposable&lt;/code&gt; interface correctly in your code. When I read others code, it is easy to pick up on subtle bugs. We need to begin to train ourselves to see the bugs and we do this by understanding what we are using. Before we begin, we need to make sure that we understand a core piece of computer science theory: Destructors.
&lt;/p&gt;

&lt;h2 id=&#34;destructors&#34;&gt;Destructors&lt;/h2&gt;

&lt;p&gt;Generally speaking, destructors are the computers way of releasing resources from an application. In environments that contain a virtual machine with a garbage collection facility, the destructor is automatically called. In these environments however, the destructor is also called a &lt;code&gt;Finalizer&lt;/code&gt;. Although these environments are &lt;s&gt;good&lt;/s&gt; excellent at managing memory for us, we cannot guarantee when the &lt;code&gt;Finalizer&lt;/code&gt; is going to be called.&lt;/p&gt;

&lt;h2 id=&#34;enter-dispose&#34;&gt;Enter Dispose&lt;/h2&gt;

&lt;p&gt;The purpose of the &lt;code&gt;Dispose&lt;/code&gt; is to guarantee when we are going to release resources. This might be at the end of a &lt;code&gt;foreach&lt;/code&gt; loop or at the end of a database connection. Either way, we have control of when we can release the resources. There are two types of resources that can be released: Managed and Unmanaged.&lt;/p&gt;

&lt;p&gt;Managed resources are typically objects that are run and controlled by the Common Language Runtime (CLR). Managed code supplies the metadata necessary for the CLR to provide services such as memory management and cross-language integration &lt;a href=&#34;http://stackoverflow.com/questions/334326/what-is-managed-unmanaged-code-in-c&#34;&gt;(Source)&lt;/a&gt;. Unmanaged resources are those outside the CLR such as Win32 API&amp;rsquo;s. These can be called from within managed code allowing some serious memory leaks if we are not careful.&lt;/p&gt;

&lt;p&gt;The .Net libraries have some useful interfaces in them, one of them being the &lt;code&gt;IDisposable&lt;/code&gt; interface. This interface has just one method called &lt;code&gt;Dispose&lt;/code&gt; (the name seems standard from what I have seen). Here is the implementation of the interface:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    public interface IDisposable
    {
       void Dispose()
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When we first implement the interface on our class, we are given the following code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    public sealed class MyClass : IDisposable
    {
        public void Dispose()
        {
            /* Release resources here */
        }
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;While this implementation is fine if you don&amp;rsquo;t mind waiting for the garbage collector to come and release the resources. What if your class has a large object inside (say ~250mb). Do you really want to wait for the garbage collector? Probably not.&lt;/p&gt;

&lt;p&gt;In order to fix our implementation, we need to do two things. Firstly, we need to implement a &lt;code&gt;Finalizer&lt;/code&gt; and then implement an overload to the original &lt;code&gt;Dispose&lt;/code&gt; method. The reason why we implement a &lt;code&gt;Finalizer&lt;/code&gt; is because we want to safe-guard ourselves if we forget to call the &lt;code&gt;Dispose&lt;/code&gt; method. For those that do not know what a &lt;code&gt;Finalizer&lt;/code&gt; looks like, here it is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    public sealed class MyClass : IDisposable
    {
        public MyClass()
        {
            /* Constructor */
        }

        public ~MyClass()
        {
            /* Destructor */
        }

        public void Dispose()
        {
            /* Release resources here */
        }
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In order to safe-guard ourselves as I just mentioned, our &lt;code&gt;Finalizer&lt;/code&gt; needs to call our &lt;code&gt;Dispose&lt;/code&gt; method like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    public ~MyClass()
    {
        /* Destructor */
        Dispose();
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You may have realised by now that we could, potentially, call the &lt;code&gt;Dispose&lt;/code&gt; twice. The user will call it once followed by the CLR calling it for us in case we forget (through the &lt;code&gt;Finalizer&lt;/code&gt;). This gives us the requirement for the overload of the &lt;code&gt;Dispose&lt;/code&gt; method I mentioned earlier. If &lt;strong&gt;we&lt;/strong&gt; call the &lt;code&gt;Dispose&lt;/code&gt; method then it is &lt;em&gt;safe&lt;/em&gt; for us to release managed resources. However, if the &lt;strong&gt;CLR&lt;/strong&gt; calls the &lt;code&gt;Dispose&lt;/code&gt; method then we cannot safely release managed resources because we do not know their current state.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The CLR runs on a background thread, which we have no control over. Therefore, we cannot know any objects state on that thread.&lt;/p&gt;

&lt;p&gt;Now that we have identified that the &lt;code&gt;Dispose&lt;/code&gt; method can be called from two places, we can implement this into our code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    public sealed class MyClass : IDisposable
    {
        public MyClass()
        {
            /* Constructor */
        }

        public ~MyClass()
        {
            /* Destructor */
            Dispose(false); // the CLR will call Dispose, so its an unsafe call
        }

        public void Dispose()
        {
            /* The interface implementation */
            Dispose(true); // WE are calling Dispose, so its a safe call
        }

        public void Dispose(bool safeToFreeManagedResources)
        {
            /* Free unmanaged resources */

            if (safeToFreeManagedResources)
            {
                /*  Free managed resources */
            }
        }
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Even though we have told the CLR that we are not to release managed resources twice, we will still release unmanaged resources twice. This is not only wasteful, but you could end up with an exception here which is something that &lt;strong&gt;SHOULD NEVER HAPPEN&lt;/strong&gt;. Luckily for us, the CLR has a neat way for us to tell it not to call the &lt;code&gt;Finalizer&lt;/code&gt; because we have already released all the resources necessary. Here is the one line magic fix:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    public void Dispose()
    {
        /* The interface implementation */
        Dispose(true); // WE are calling Dispose, so its a safe call
        GC.SuppressFinalize(this); // WE have called dispose, there is no need to call it again Mr. GC.
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;best-practise&#34;&gt;Best Practise&lt;/h2&gt;

&lt;p&gt;Now that we have our code fixed, without any issues or bugs, it&amp;rsquo;s time to know a best practise. When an object implements the &lt;code&gt;IDisposable&lt;/code&gt; interface, we have the opportunity to use the &lt;code&gt;using&lt;/code&gt; statement. The idea of the &lt;code&gt;using&lt;/code&gt; statement is that once you have finished with the object, the CLR will call the &lt;code&gt;Dispose&lt;/code&gt; method for you. Note I said &lt;code&gt;Dispose&lt;/code&gt; not the &lt;code&gt;Finalizer&lt;/code&gt;. The &lt;code&gt;using&lt;/code&gt; statement is really easy to use:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    static void Main(string[] args)
    {
        using (var myClass = new MyClass())
        {
            /* Do stuff here */
        }
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When the compiler sees this code, it actually expands it to this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    static void Main(string[] args)
    {
        var myClass = new MyClass();
        try
        {
            /* Do stuff here */
        }
        finally
        {
            myClass.Dispose();
        }
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So there it is. Hopefully now you can implement &lt;code&gt;IDisposable&lt;/code&gt; correctly according to your needs.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Semaphore vs SeamphoreSlim Micro Benchmark</title>
      <link>https://im5tu.io/article/2013/03/semaphore-vs-seamphoreslim-micro-benchmark/</link>
      <pubDate>Mon, 11 Mar 2013 18:06:28 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2013/03/semaphore-vs-seamphoreslim-micro-benchmark/</guid>
      <description>&lt;p&gt;In this post, I am going to show a small micro-benchmark to demonstrate the performance difference between the &lt;code&gt;Semaphore&lt;/code&gt; and &lt;code&gt;SemaphoreSlim&lt;/code&gt; classes in C#. A &lt;code&gt;Semaphore&lt;/code&gt; is often used to restrict the number of threads than can access some (physical or logical) resource. In this case, we want the restriction to be as little as possible.
&lt;/p&gt;

&lt;p&gt;Semaphores are of two types: local semaphores and named system semaphores. If you create a Semaphore object using a constructor that accepts a name, it is associated with an operating-system semaphore of that name. Named system semaphores are visible throughout the operating system, and can be used to synchronize the activities of processes. You can create multiple Semaphore objects that represent the same named system semaphore, and you can use the OpenExisting method to open an existing named system semaphore. &lt;em&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-gb/library/system.threading.semaphore.aspx&#34;&gt;Source&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;A local semaphore exists only within your process. It can be used by any thread in your process that has a reference to the local Semaphore object. Each Semaphore object is a separate local semaphore. &lt;em&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-gb/library/system.threading.semaphore.aspx&#34;&gt;Source&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The machine that I am using for this benchmark is a Intel core i3, clocked at 4ghz with 4GB DDR3 ram running Windows 7 x64 SP1 and .Net Framework 4.5.&lt;/p&gt;

&lt;p&gt;In order to begin the test, I created a new console application and imported the BMark package from the &lt;a href=&#34;https://nuget.org/packages/BMark/&#34;&gt;NuGet&lt;/a&gt; repository. Next, I added the following code to the application as shown below:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;const Int32 count = 106;

Semaphore regularSemaphore = new Semaphore(count, count);
SemaphoreSlim slimSemaphore = new SemaphoreSlim(count, count);

UInt64 amountToRun = (UInt64)(count - PerformanceTester.PreRunAmount - 2);

PerformanceTester.Run(&amp;quot;Semaphore.WaitOne&amp;quot;, amountToRun, () =&amp;gt; { regularSemaphore.WaitOne(); });
PerformanceTester.Run(&amp;quot;Semaphore.Release&amp;quot;, amountToRun, () =&amp;gt; { regularSemaphore.Release(); });
PerformanceTester.Run(&amp;quot;SemaphoreSlim.WaitOne&amp;quot;, amountToRun, () =&amp;gt; { slimSemaphore.Wait(); });
PerformanceTester.Run(&amp;quot;SemaphoreSlim.Release&amp;quot;, amountToRun, () =&amp;gt; { slimSemaphore.Release(); });

Console.WriteLine(PerformanceTester.GetResults());
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;By default, the &lt;code&gt;PerformanceTester&lt;/code&gt; will run each test 4 times before starting the actual timed test. Since we are dealing with a blocking resource, I added some extra capacity so that the test would not block at any point. When the code is run in release mode without the debugger, the output of the program is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Semaphore.WaitOne:         0.09ms    NumberOfSamples: 100
Semaphore.Release:         0.05ms    NumberOfSamples: 100
SemaphoreSlim.WaitOne:     0.01ms    NumberOfSamples: 100
SemaphoreSlim.Release:     0.01ms    NumberOfSamples: 100
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As the results show, the &lt;code&gt;SemaphoreSlim&lt;/code&gt; class is a tiny bit quicker. After testing this myself earlier, I thought that others could run this themselves and hopefully receive a small increase in performance in their applications. The reason for the performance increase is because the &lt;code&gt;SemaphoreSlim&lt;/code&gt; class provides a lightweight alternative to the &lt;code&gt;Semaphore&lt;/code&gt; class that doesn&amp;rsquo;t use Windows kernel semaphores.&lt;/p&gt;

&lt;p&gt;In essence, if you do not need a named &lt;code&gt;Semaphore&lt;/code&gt;, use the &lt;code&gt;SemaphoreSlim&lt;/code&gt; class.&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Flicker free forms and listview in .Net</title>
      <link>https://im5tu.io/article/2012/12/flicker-free-forms-and-listview-in-.net/</link>
      <pubDate>Sun, 30 Dec 2012 14:51:38 +0000</pubDate>
      
      <guid>https://im5tu.io/article/2012/12/flicker-free-forms-and-listview-in-.net/</guid>
      <description>&lt;p&gt;On a project I have been working on recently, I came across a problem where under Windows an Mdi Child form would flicker when it loads. Trying to find information on what was the cause of this was near impossible. I ended up trying a lot of code snippets that I found when googling the problem and this is what I have come up with.
&lt;/p&gt;

&lt;p&gt;Next up, the code. Following this I shall explain, to the best of my ability, what the code does:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#39;  VB
    Protected Overrides ReadOnly Property CreateParams() As System.Windows.Forms.CreateParams
        Get
            Dim cp As CreateParams = MyBase.CreateParams
            cp.ExStyle = cp.ExStyle Or &amp;amp;H2000000
            Return cp
        End Get
    End Property
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Apparently there are two causes for the flicker that happens to a Windows form. Until writing this post I did not know of the reasons why. &lt;em&gt;&lt;a href=&#34;http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/aaed00ce-4bc9-424e-8c05-c30213171c2c/&#34;&gt;Source MSDN
Forums&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1.&lt;/strong&gt; &lt;em&gt;Windows sends a control two messages when a control needs to be painted. The first one (&lt;code&gt;WM_ERASEBKGND&lt;/code&gt;) causes the background to be painted (&lt;code&gt;OnPaintBackground&lt;/code&gt;), the second causes the foreground to be painted (&lt;code&gt;WM_PAINT&lt;/code&gt;, firing &lt;code&gt;OnPaint&lt;/code&gt;). Seeing the background drawn first, then the foreground is noticeable when the drawing is slow. Windows Forms has a ready solution for this kind of flicker with ControlStyles.OptimizedDoubleBuffer.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2.&lt;/strong&gt; &lt;em&gt;A form that has a lot of controls takes a long time to paint. Especially the Button control in its default style is expensive. Once you get over 50 controls, it starts getting noticeable. The Form class
paints its background first and leaves &amp;ldquo;holes&amp;rdquo; where the controls need to go. Those holes are usually white, black when you use the &lt;code&gt;Opacity&lt;/code&gt; or &lt;code&gt;TransparencyKey property&lt;/code&gt;. Then each control gets painted, filling
in the holes. The visual effect is ugly and there&amp;rsquo;s no ready solution for it in Windows Forms. &lt;code&gt;Double-buffering&lt;/code&gt; can&amp;rsquo;t solve it as it only works for a single control, not a composite set of controls.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;CreateParams&lt;/code&gt; property should only be overridden when wrapping an existing Windows control or when you need to set the style of the control. Microsoft recommend that you inherit the problem control and
then override the &lt;code&gt;CreateParams&lt;/code&gt;, not the way that I actually used it.&lt;/p&gt;

&lt;p&gt;I applied this at the top of every form in my code, ran the code under Windows 7 (my development machine) and Windows XP (the target machine) and everything appeared to render a lot better with the nasty double
flicker gone. All I know about the code above, is that it overrides the styling of the controls and waits until the form is fully painted before showing the form.&lt;/p&gt;

&lt;p&gt;It wasn&amp;rsquo;t until further testing of the code that I discovered that the original code caused an MDI child form to max out the CPU and hang the application. I tried commenting out all of the code, removing any
background threads that were running (including timers etc) and as soon as I enabled the code, it would hang the application again. This left me and my colleagues very stumped for a few hours. After this period of
time, I bit the bullet and decided to uncomment every section of my code until I could find the problem.&lt;/p&gt;

&lt;p&gt;Eventually I found the code above to be the problem, which worked fine under Windows 7. So the solution was quiet easy, detect what version of the operating system we are on and only apply the style if we are on
Vista or higher.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#39;  VB
    Protected Overrides ReadOnly Property CreateParams() As System.Windows.Forms.CreateParams
        Get
            Dim cp As CreateParams = MyBase.CreateParams
            Dim OSVer As Version = System.Environment.OSVersion.Version()
            Select Case OSVer.Major
                Case Is &amp;lt;= 5
                Case 5
                    If OSVer.Minor &amp;gt; 0 Then
                        cp.ExStyle = cp.ExStyle Or &amp;amp;H2000000
                    End If
                Case Is &amp;gt; 5
                    cp.ExStyle = cp.ExStyle Or &amp;amp;H2000000
                Case Else
            End Select
            Return cp
        End Get
    End Property
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So I had finally fixed the problem with the CPU usage. Deployed the version for the client to test and everything was ok. By this time, I had a massive headache and it wasn&amp;rsquo;t quiet the end of the day. What a
better way to end the day but by ending off with another rending issue. Although I had fixed the issue with the CPU, I had noticed that when you moved the form, and loading the form in some cases, a list view in
details mode would not render correctly.&lt;/p&gt;

&lt;p&gt;After reading around about the issue, I have merged from a number of source&amp;rsquo;s to create a flicker free list view. To use the code, place the class into your project, open up the target form&amp;rsquo;s designer code (&lt;em&gt;You
will need to show all files in VS&lt;/em&gt;) and replace the instances of &lt;code&gt;ListView&lt;/code&gt; with &lt;code&gt;FlickerFreeListView&lt;/code&gt;. Here is the code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Public Class FlickerFreeListView
    Inherits System.Windows.Forms.ListView

    Public Sub New()

        MyBase.New()

        Me.SetStyle(ControlStyles.Opaque, True)
        Me.SetStyle(ControlStyles.OptimizedDoubleBuffer, True)
        Me.SetStyle(ControlStyles.ResizeRedraw, True)
        Me.SetStyle(ControlStyles.AllPaintingInWmPaint, True)
        Me.SetStyle(ControlStyles.EnableNotifyMessage, True)

    End Sub

    Protected Overrides Sub OnNotifyMessage(ByVal m As Message)
        If (m.Msg &amp;lt;&amp;gt; &amp;amp;H14) Then
            MyBase.OnNotifyMessage(m)
        End If
    End Sub

End Class
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The code basically blocks the background from being re-drawn every time an item is added into the &lt;code&gt;ListView&lt;/code&gt; control. It also sets the &lt;code&gt;OptimizedDoubleBuffer&lt;/code&gt; to help prevent any issues, amongst other things.&lt;/p&gt;

&lt;p&gt;I hope that this will help someone have less of a headache that I had when I was looking around for a solution to this problem. Feel free to try it at your own risk and notify me if you have any
troubles.&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>