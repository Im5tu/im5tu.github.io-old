<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Up and running with URL Rewrite - going from HTTP to HTTPS - Stuart Blackler's Blog</title><link rel=canonical href=https://im5tu.io/article/2017/06/up-and-running-with-url-rewrite-going-from-http-to-https/><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><meta name=description content="A quick introduction to URL Rewrite module for IIS and a snippet from going from HTTP to HTTPS."><meta property="og:title" content="Up and running with URL Rewrite - going from HTTP to HTTPS - Stuart Blackler's Blog"><meta property="og:type" content="website"><meta property="og:description" content="A quick introduction to URL Rewrite module for IIS and a snippet from going from HTTP to HTTPS."><meta property="og:url" content="https://im5tu.io/article/2017/06/up-and-running-with-url-rewrite-going-from-http-to-https/"><meta property="og:image" content="https://im5tu.io/img/profile.jpg"><meta property="og:site_name" content="Stuart Blackler's Blog"><meta name=twitter:card content="summary"><meta name=twitter:site content="@im5tu"><style>body,html{height:100%;color:#303030;font-family:noto sans,helvetica neue,Helvetica,Arial,sans-serif;font-display:auto;line-height:1.8em}h1,h2,h3,h4,h5,h6{font-family:Comfortaa,helvetica neue,Helvetica,Arial,sans-serif;font-display:auto}p{margin:1.5em 0}blockquote{border-left:5px solid #454545;background-color:#fafafa;padding:.5em 1.5em}blockquote,blockquote p{color:#494949}blockquote~blockquote{margin-top:0;margin-bottom:0}.warning{margin:0 auto;border:1px solid #ff9500;color:#ff9500;background-color:#fff;text-align:center}.series{font-style:italic}.series p{margin-bottom:0}.series ol{margin:0}.pageContainer{text-align:justify}.pageWrap{margin:0 auto;max-width:1400px}@media screen and (min-width:320px){.pageWrap{width:97%}}@media screen and (min-width:740px){.pageWrap{width:90%}}@media screen and (min-width:980px){.pageWrap{width:80%}}.pageWrap:after{content:"";display:table;clear:both}a{font-family:Comfortaa,helvetica neue,Helvetica,Arial,sans-serif;font-display:auto}a:link,a:visited{color:#149fd1}a:link{text-decoration:none}a:hover{color:#2db9eb;text-decoration:underline}#pageHeader-about{border-bottom:1px solid #eaeaea}#pageHeader-about-title a{font-size:1.2em}#pageHeader-about-title a:link,#pageHeader-about-title a:visited{color:#232323}#pageHeader-about-title a:first-child{font-size:1.1em;color:#149fd1;text-transform:none}.article-list a{color:#0a0a0a}.article-list a:hover{color:#2db9eb;text-decoration:underline}.article-content li code,.article-content p code{color:#149fd1;background-color:rgba(27,31,35,.05)}.article-content li code:hover,.article-content p code:hover{opacity:.5}.article img{max-width:100%}ul.article-tags{display:inline;padding:0}ul.article-tags li{display:inline;padding:0 1em}ul.article-tags li a:link{text-decoration:underline}table{width:100%}table *{padding:0;margin:0}table th{display:-webkit-box;display:flex;width:100%;background:#000;color:#fff;padding:1em}table tr{display:-webkit-box;display:flex;width:100%}table tr:hover{opacity:.7}table tr:first-child{padding:0}table tr:nth-of-type(odd){background:#eee}table td{-webkit-box-flex:1;flex:1 1 20%;text-align:left;padding:1em}pre{line-height:1.4em}code{font-size:1.2em}@media(prefers-color-scheme:dark){body,html{color:#eaeaea;background:#323232}h1,h2,h3,h4,h5,h6{color:#fefefe}a:link,a:visited{color:#149fd1}.article-list h1 a:link,.article-list h1 a:visited,.article-list h2 a:link,.article-list h2 a:visited,.article-list h3 a:link,.article-list h3 a:visited,.article-list h4 a:link,.article-list h4 a:visited,.article-list h5 a:link,.article-list h5 a:visited,.article-list h6 a:link,.article-list h6 a:visited{color:#fefefe}#pageHeader-about-title a:link,#pageHeader-about-title a:visited{color:#dedede}#pageHeader-about-title a:first-child{color:#149fd1}table tr:nth-of-type(odd){background:#767676}pre,pre code{background:#dcdcdc!important;color:#323232}}.copy-code-button{float:right;display:block;padding:8px 12px;font-size:.9em;background-color:#e2e2e2;border:1px solid #e2e2e2;border-radius:0 0 10px 10px;-webkit-transition:all 250ms ease;transition:all 250ms ease;opacity:0}.copy-code-button:hover{cursor:pointer;opacity:.7;border-style:solid}.copy-code-button:focus{background-color:#e2e2e2;outline:0;border-style:solid}.copy-code-button:active{background-color:#e2e2e2;opacity:.5;border-style:solid}pre:hover .copy-code-button{opacity:1}.copy-code-button~pre{position:relative}@media print{.copy-code-button{display:none}}@media(prefers-color-scheme:dark){.copy-code-button{background-color:#969696;color:#323232}}</style><link href="https://fonts.googleapis.com/css?family=Comfortaa|Noto+Sans&display=swap" rel=stylesheet><link href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/tomorrow.min.css rel=stylesheet><link href=/article/index.xml rel=alternate type=application/rss+xml title="Stuart Blackler's Blog"></head><body><section class=pageContainer><header id=pageHeader><section id=pageHeader-about class=pageWrap itemscope itemtype=http://schema.org/person><section id=pageHeader-about-title><h1 itemprop=name><a href=/ title="Stuart Blackler">@im5tu</a> / <a href=https://im5tu.io/article/2017/06/up-and-running-with-url-rewrite-going-from-http-to-https/>Up and running with URL Rewrite - going from HTTP to HTTPS</a></h1></section></section></header><section class="pageContainer-content pageWrap"><article class=article itemscope itemtype=http://schema.org/blog><section class=article-content itemprop=text><p>In this series, I am going to take you through a few <code>web.config</code> snippets that have come in handy for me when using URL Rewrite on IIS. Firstly, I am going to introduce the URL Rewrite module then show a sample of going from HTTP to HTTPS.</p><h2 id=what-is-url-rewrite>What is URL Rewrite?</h2><p><a href=https://www.iis.net/downloads/microsoft/url-rewrite>URL Rewrite</a> is a module extensions for IIS which allows administrators to create powerful inbound and outbound rules that alter a HTTP request or response. Scenarios where you might consider using the URL Rewrite module include:</p><ul><li>Rewrite URLs based on the values of server variables or HTTP headers</li><li>Provide SEO benefits such as canonical host names</li><li>Setup redirects from old posts to new</li></ul><p><em>URL rewrite can be install from the <a href="http://go.microsoft.com/fwlink/?LinkID=615137">Web Platform Installer</a> for IIS 7.5 or above.</em></p><h2 id=url-rewrite-and-webconfig>URL Rewrite and Web.Config</h2><p>Inside of the <code>web.config</code> you can define a <code>&lt;rewrite></code> section beneath the <code>&lt;system.web></code> section:</p><pre><code class=language-xml>&lt;system.web&gt;
    &lt;rewrite&gt;
        &lt;!-- Your rules here --&gt;
    &lt;/rewrite&gt;
&lt;/system.web&gt;
</code></pre><p>Within the <code>&lt;rewrite></code> section you can define either a <code>&lt;rules></code> section or an <code>&lt;outbound></code> section. The former is for inbound request rewriting and the latter is for response rewriting. I'll expand on each section as we go through the series.</p><p><em><strong>Note:</strong> if you don't have the URL Rewrite module installed, you'll get a lovely yellow screen of death when you start your application.</em></p><h2 id=redirecting-http-to-https>Redirecting HTTP to HTTPS</h2><p>The are some obvious benefits to serving pages over a secure connection (HTTPS), which include:</p><ul><li>Encryption: The data exchanged between client and server cannot easily be read</li><li>Authority: Proving that the server you are talking to is who you are expecting to talk to</li></ul><p>However, there are a few lesser known benefits including:</p><ul><li>SEO: Search engines are preferring websites that are secure by default</li><li>HTTP2: Major browsers do not support HTTP2 over insecure connections</li></ul><p>Assuming you would like all of the above benefit, here is the rule snippet that you will need:</p><pre><code class=language-xml>&lt;system.web&gt;
    &lt;rewrite&gt;
        &lt;rules&gt;
            &lt;rule name=&quot;Redirect to http&quot; patternSyntax=&quot;Wildcard&quot; stopProcessing=&quot;true&quot;&gt;
            &lt;match url=&quot;*&quot; negate=&quot;false&quot; /&gt;
            &lt;conditions logicalGrouping=&quot;MatchAny&quot; trackAllCaptures=&quot;false&quot;&gt;
                    &lt;add input=&quot;{HTTPS}&quot; pattern=&quot;off&quot; /&gt;
                &lt;/conditions&gt;
            &lt;action type=&quot;Redirect&quot; url=&quot;https://{HTTP_HOST}/{R:1}&quot; redirectType=&quot;Temporary&quot; /&gt;
        &lt;/rule&gt;
        &lt;/rules&gt;
    &lt;/rewrite&gt;
&lt;/system.web&gt;
</code></pre><p>So what's going on in the snippet above?</p><p>In the first line, we are defining the name of the rule which can be viewed inside of <code>inetmgr (IIS Manager)</code>; saying which pattern style we are going to use (either regex or wildcard) and saying that we want to stop at this rule and return the response to the client. Next up, we give our matching criteria which we have wildcarded to match all requests. Then we have added a condition which takes a server variable (<code>{HTTPS}</code> which indicates whether or not this request has been delivered over a secure connection), and made sure we only track insecure requests.</p><p><em>With conditions inside of a rule, you can match a single entry in the condition set or all the conditions within the set. Use either <code>MatchAny</code> or <code>MatchAll</code> depending on your needs.</em></p><p>Finally, we define the action that we wish to take if both the <code>match</code> and <code>conditions</code> sections have been satisfied. The action <code>type</code> can be <code>Redirect</code> or <code>Rewrite</code> depending on your needs. We wish to redirect a user to a secure connection, so we define the type as <code>Redirect</code> and the url equal to a secure connection to the host requested with the original path & query appended. The final attribute is the redirect type which can be one of the following:</p><ul><li>Permenant: <a href=https://httpstatuses.com/301>A HTTP 301 Response</a></li><li>Found: <a href=https://httpstatuses.com/302>A HTTP 302 Response</a></li><li>SeeOther: <a href=https://httpstatuses.com/303>A HTTP 303 Response</a></li><li>Temporary: <a href=https://httpstatuses.com/307>A HTTP 307 Response</a></li></ul><p>That's it! Hopefully this article gives you everything that you need to get HTTP to HTTPS redirects working without</p><h2 id=other-posts-in-this-series>Other Posts In This Series</h2><ol><li><a href=/article/2017/06/up-and-running-with-url-rewrite---going-from-http-to-https/>Up and running with URL Rewrite - going from HTTP to HTTPS</a> <em>(This Post)</em></li><li><a href=/article/2017/06/canonical-host-urls-with-url-rewrite/>Canonical host urls with URL Rewrite</a></li><li><a href=/article/2017/06/removing-trailing-slashes-with-url-rewrite/>Removing trailing slashes with URL Rewrite</a></li><li><a href=/article/2017/06/ensuring-httponly-cookies-with-url-rewrite/>Ensuring httpOnly cookies with URL Rewrite</a></li><li><a href=/article/2017/06/ensuring-secure-cookies-with-url-rewrite/>Ensuring secure cookies with URL Rewrite</a></li><li><a href=/article/2017/06/ensuring-samesite-cookies-with-url-rewrite/>Ensuring samesite cookies with URL Rewrite</a></li></ol></section><footer class=article-footer><hr>Tags:<ul class=article-tags><li><a class=article-tag href=/tags/iis/>IIS</a></li><li><a class=article-tag href=/tags/url-rewrite/>Url Rewrite</a></li></ul></footer></article></section><footer id=pageFooter class=pageWrap><p>&copy; 2020 <span itemprop=author>Stuart Blackler</span>. Last Updated: <time itemprop=datecreated class=article-header-time pubdate=pubdate datetime=2017-06-03T15:00:51>2017-06-03 15:00:51 +0100 BST</time>. <a id=pageFooter-scroll-link href=#>Scroll To Top</a>.</p></footer></section><script src=/js/site-54e01995.js defer></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-88036425-1','auto');ga('send','pageview');</script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>